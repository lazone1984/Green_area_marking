# CAD面积标注工具 (PlantMark)

一个用于CAD图纸中面积计算、标注和填充的专业工具，特别适用于绿化面积的计算和标注。

## 主要功能

### 1. 面积标注
- 支持多图层选择和标注
- 自动计算并标注面积数值
- 支持毫米/米单位切换
- 自定义标注字体大小
- 自定义标注图层管理
  - 默认图层：0-绿化面积标注
  - 支持新建自定义图层
- 支持三种标注类型
  - 标记
  - 数字
  - 综合

### 2. 面积计算
- 红线范围面积计算
- 地下车库覆盖面积识别
  - 自动识别地库重叠区域
  - 自动应用80%折算系数
- 面积折算功能
  - 支持多种折算系数(100%, 80%, 50%, 30%, 10%)
  - 根据《园林绿化工程施工及验收规范》自动计算
- 绿地率自动计算
  - 自动统计总实测面积
  - 自动统计总折算面积
  - 计算绿地率百分比

### 3. 图案填充
- 三种专业填充样式
  - ANSI31
  - CROSS (默认)
  - GRASS
- 颜色选择功能
  - 红色 (1)
  - 黄色 (2)
  - 绿色 (3, 默认)
  - 青色 (4)
  - 蓝色 (5)
  - 洋红 (6)
  - 白色 (7)
  - 灰色 (8)
- 自定义填充角度
- 自定义填充比例(0.001-10000)

### 4. 数据导出
- 支持多种格式导出
  - Word文档
  - Excel表格
  - PowerPoint演示文稿
  - WPS文档
  - 插入CAD图纸
- 导出内容包括
  - 序号和实测面积
  - 折算系数和折算面积
  - 面积汇总数据
  - 红线面积和绿地率

### 5. 数据保存
- 自动保存上次设置
  - 选择的图层
  - 单位和字高
  - 红线面积数据
  - 地库线范围
  - 已标注的面积数据
  - 填充样式设置
  - CAD文件名

## 项目结构

## 项目概述
PlantMark 是一个 CAD 面积标注工具，用于计算和标注 CAD 图纸中的面积，特别适用于绿化面积的计算和标注。

## 代码结构图
PlantMark/
├── main.py        # 程序入口文件
├── assets/        # 资源文件目录
│   ├── icon.py    # 程序图标数据
│   └── qr_codes.py # 收款码数据
├── convert_icon.py # 图标转换工具
├── ui/            # 用户界面相关模块
│   ├── plant_mark_ui.py # 主界面实现
│   ├── ui_components.py # UI组件
│   └── window_manager.py # 窗口管理
├── export_manager.py # 导出功能管理
├── cad/           # CAD相关模块
│   ├── plant_mark.py # CAD操作核心功能
│   └── cad_detector.py # CAD软件检测模块
├── utils/         # 工具模块
│   └── settings_manager.py # 设置管理
└── README.md      # 项目说明文档

这个代码结构图展示了PlantMark项目的文件和目录结构，方便开发者和用户快速了解项目的组成和功能。
PlantMark/: 项目根目录。
main.py: 程序的入口文件，运行此文件即可启动PlantMark。
assets/: 存放项目所需的各种资源文件，如图标、收款码等。
icon.py: 存储程序图标的数据。
qr_codes.py: 存储收款码相关数据。
convert_icon.py: 一个实用工具，用于转换图标文件的格式。
ui/: 包含用户界面相关的模块。
plant_mark_ui.py: 实现程序的主界面。
ui_components.py: 封装各种UI组件，方便界面开发。
window_manager.py: 管理程序窗口的创建、显示和销毁等操作。
export_manager.py: 负责导出PlantMark生成的数据或结果。
cad/: 与CAD软件交互相关的模块。
plant_mark.py: 实现与CAD软件进行交互的核心功能。
cad_detector.py: 用于检测计算机上是否安装了特定的CAD软件。
utils/: 存放一些通用的工具模块。
settings_manager.py: 管理PlantMark的各项设置，如保存、加载配置等。
README.md: 项目的说明文档，包含项目介绍、使用方法、代码结构说明等。
